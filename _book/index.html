<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topics in Bayesian Computing</title>
  <meta name="description" content="Topics in Bayesian Computing" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Topics in Bayesian Computing" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topics in Bayesian Computing" />
  
  
  



<meta name="date" content="2020-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Latex macros for html output

A few very common things you should use:

- $\bm{}$: Bold math.  Use bold for everything except scalars.
- $\tx{}$: Text within math.  Use for abbreviating words, e.g., $A_{\tx{miss}}$.
- $\xx, \YY$: Default macro convention for bold letters (small and capital case).
- $\aal, \TTh$: Default macro convention for bold symbols (first two letters of symbol name, i.e., $\bm{\alpha}$ and $\bm{\Theta}$).
- common stats symbols e.g., $\var$, $\cov$, $\iid$, $\N, defined below.
-->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      TeX: {
	  Macros: {
	      bm: ["\\boldsymbol{#1}",1],
	      tx: ["\\textrm{#1}",1],
	      iid: ["\\overset{\\;\\tx{iid}\\;}{\\sim}"],
	      ind: ["\\overset{\\:\\tx{ind}\\:}{\\sim}"],
	      var: ["\\operatorname{var}"],
	      cov: ["\\operatorname{cov}"],
	      cor: ["\\operatorname{cor}"],
	      N: ["\\mathcal{N}"],
	      ww: ["{\\bm{w}}"],
	      xx: ["{\\bm{x}}"],
	      yy: ["{\\bm{y}}"],
	      zz: ["{\\bm{z}}"],
	      XX: ["{\\bm{X}}"],
	      YY: ["{\\bm{Y}}"],
	      ZZ: ["{\\bm{Z}}"],
	      aal: ["{\\bm{\\alpha}}"],
	      bbe: ["{\\bm{\\beta}}"],
	      gga: ["{\\bm{\\gamma}}"],
	      eet: ["{\\bm{\\eta}}"],
	      lla: ["{\\bm{\\lambda}}"],
	      mmu: ["{\\bm{\\mu}}"],
	      pph: ["{\\bm{\\phi}}"],
	      pps: ["{\\bm{\\psi}}"],
	      rrh: ["{\\bm{\\rho}}"],
	      ssi: ["{\\bm{\\sigma}}"],
	      tta: ["{\\bm{\\tau}}"],
	      tth: ["{\\bm{\\theta}}"],
	      GGa: ["{\\bm{\\Gamma}}"],
	      SSi: ["{\\bm{\\Sigma}}"],
	      TTh: ["{\\bm{\\Theta}}"]
	  }
      }
  });
</script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="#applications-of-bayesian-nonparametric-methods"><i class="fa fa-check"></i><b>1</b> Applications of Bayesian Nonparametric Methods</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="#problem-statement"><i class="fa fa-check"></i><b>1.1</b> Problem Statement</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="#tools-and-setup"><i class="fa fa-check"></i><b>1.2</b> Tools and Setup</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="#tools"><i class="fa fa-check"></i><b>1.2.1</b> Tools</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="#installation"><i class="fa fa-check"></i><b>1.2.2</b> First Time Installation and Setup</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="#next-time-system-startup"><i class="fa fa-check"></i><b>1.2.3</b> Next Time System Startup</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="#jupyter-application-files"><i class="fa fa-check"></i><b>1.3</b> Jupyter Application Files</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="#jupyer-notebook-code-examples"><i class="fa fa-check"></i><b>1.3.1</b> Jupyer Notebook Code Examples</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="#future-research-notes-and-thoughts-towards-a-stat946-final-project"><i class="fa fa-check"></i><b>1.4</b> Future Research | Notes and Thoughts Towards a STAT946 Final Project</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="#future-research"><i class="fa fa-check"></i><b>1.4.1</b> Future Research</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="#to-do"><i class="fa fa-check"></i><b>1.5</b> To Do</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Topics in Bayesian Computing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Topics in Bayesian Computing</h1>
<p class="author"><em><div class="line-block"><strong>Class of STAT 946, Spring 2020</strong><br />
<strong>University of Waterloo</strong></div></em></p>
<p class="date"><em>2020-07-02</em></p>
</div>
<div id="applications-of-bayesian-nonparametric-methods" class="section level1">
<h1><span class="header-section-number">1</span> Applications of Bayesian Nonparametric Methods</h1>
<div id="problem-statement" class="section level2">
<h2><span class="header-section-number">1.1</span> Problem Statement</h2>
<p>The advent of cheap data storage, ubiquitous networks, and fully connected sensing devices brings with it the possibility to control and monitor processes at scale. Statistical learning methods have enjoyed great success in a number of use cases but a major barrier to their widespread adoption across the internet of things lies in the effort required to achieve useful implementations. Take for example anomaly detection. A typical industrial work place might have tens to hundreds of thousands of measured signals - each with its own set of characteristics behaviors and failure modes. Ideally monitoring and control solutions in these contexts need to be generalized to the extent that they can be applied without specific training or dataset for each signal/device type and failure mode.</p>
<p>In the following sections we will take a look at using BNP methods for anomaly detection and signal clustering in a set of industrial process variables. The first example will demonstrate single variate anomaly detection, and the second will look at the multivariate case for clustering.</p>
</div>
<div id="tools-and-setup" class="section level2">
<h2><span class="header-section-number">1.2</span> Tools and Setup</h2>
<div id="tools" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Tools</h3>
<div id="mit-probcomp" class="section level4">
<h4><span class="header-section-number">1.2.1.1</span> MIT Probcomp</h4>
<p>The following provides a brief description of the tools we require to perform bnp based anomaly detection. And the following section gives a set of instructions for installing the required environment.</p>
<p>The MIT Probabilistic Computing Project has made available <a href="https://github.com/probcomp"><strong>probcomp</strong></a> which is a set of libraries written to support the application of artificial intelligence. To perform anomaly detection we will use some of the functionality provided by <strong>cgpm</strong>, <strong>crosscat</strong>, and <strong>trcrpm</strong>.</p>
<p><strong>cgpm</strong> is a repository of code to support the implementation of Composable Generative Population Models(CGPM). CGPM provide a layer of abstraction that supports model composition and provides avenues for both sampling of random variable and generation of conditional densities. <strong>crosscat</strong> provides tools for the Bayesian analysis of high dimensional data tables to support efficient sampling and joint distribution estimation via Bayesian network structure learning and nonparametric mixture modelling. <strong>crosscat</strong> can be used to identify predictive relationships between variables, uncover complex clustering. Both <strong>crosscat</strong> and <strong>cgpm</strong> make extensive use of <strong>cython</strong> and the associated <strong>c++</strong> backend.</p>
<p><strong>trcrpm</strong> is an implementation of Temporally Reweighted Chinese Restaurant Process Mixture Models described in <span class="citation">(Saad and Mansinghka <a href="#ref-saad2018trcrpm" role="doc-biblioref">2018</a>)</span>. <strong>trcrpm</strong> makes calls to <strong>cgpm</strong> and <strong>crosscat</strong> to provide a modified version of the Chinese Restaurant Process that introduces a time dependency between successive states of the model.</p>
</div>
</div>
<div id="installation" class="section level3">
<h3><span class="header-section-number">1.2.2</span> First Time Installation and Setup</h3>
<p>The following instruction assume the user has root access to a local system running <strong>ubuntu 18.04</strong> and a working <strong>git</strong> installation.</p>
<p><strong>crosscat</strong>, <strong>cgpm</strong>, and <strong>trcrpm</strong> are all implemented in <strong>python 2.7</strong> and tested on <strong>ubuntu 16.04</strong>. The <strong>trcrpm</strong> repository includes a <strong>docker</strong> file for a container with all the required dependencies. We make use of this docker file and the <strong>jupyter notebook</strong> system to create and run a container on a local system from which to access the code required for the application.</p>
<p>To install docker, at a console in <strong>ubuntu 18.04</strong> run the following:</p>
<pre><code># update the apt cache
sudo apt update
# install and update certificate support for docker
sudo apt install apt-transport-https ca-certificates curl software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable&quot;
# update the apt cache to include the newly added/trusted docker repositories
sudo apt update
# install docker
sudo apt install docker-ce</code></pre>
<p>To allow your current non-root user to run docker, and update your user credentials, run the following and enter your your password at the prompt:</p>
<pre><code>sudo usermod -aG docker ${USER}
su - ${USER}</code></pre>
<p>Next clone the <strong>bnp_time_series</strong> repository in your desired directory:</p>
<pre><code>git clone https://github.com/nick-torenvliet/bnp_time_series.git</code></pre>
<p>Enter the docker directory:</p>
<pre><code>cd docker</code></pre>
<p>Create a docker container for the application:</p>
<pre><code>docker build --tag bnp_time_series:00.00 .</code></pre>
<p>Start the docker container with a shell:</p>
<pre><code>docker run -p 8888:8888 -it bnp_time_series:00.00 </code></pre>
<p>In the docker container shell clone the bnp_time_series repository:</p>
<pre><code>git clone https://github.com/nick-torenvliet/bnp_time_series.git</code></pre>
<p>Change directories to the bnp_time_series directory:</p>
<pre><code>cd bnp_time_series</code></pre>
<p>Activate the python virtual environment:</p>
<pre><code>source /venv/bin/activate</code></pre>
<p>Start <strong>jupyter notebook</strong>:</p>
<pre><code>jupyter notebook --no-browser --port 8888 --ip 0.0.0.0 --allow-root</code></pre>
<p>You will get system output that looks something like this:</p>
<pre><code>[C 19:59:16.143 NotebookApp] 
    
    To access the notebook, open this file in a browser:
        file:///root/.local/share/jupyter/runtime/nbserver-54-open.html
    Or copy and paste one of these URLs:
        http://(d59a4f26bf5d or 127.0.0.1):8888/?token=31fa0215191e6636abf09477761404d35484a4614aab4399
</code></pre>
<p>Copy the URL and paste it into a browser address bar. Before following the URL, edit it so it is well-formed as the following:</p>
<pre><code>http://127.0.0.1:8888/?token=31fa0215191e6636abf09477761404d35484a4614aab4399</code></pre>
<p>You now should have <strong>jupyter notebook</strong> running in your browser, on the container just created.</p>
</div>
<div id="next-time-system-startup" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Next Time System Startup</h3>
<p>If you’ve successfully performed all the step in [#installation] and want to come back to the system after shutting down the docker container only the following steps need to be performed.</p>
<p>Start the docker container with a shell:</p>
<pre><code>docker run -p 8888:8888 -it bnp_time_series:00.00 
git clone https://github.com/nick-torenvliet/bnp_time_series.git
cd bnp_time_series
source /venv/bin/activate
jupyter notebook --no-browser --port 8888 --ip 0.0.0.0 --allow-root</code></pre>
<p><strong>jupyter notebook</strong> is now again accessible from the URL provided in the startup output.</p>
<p>There are methods to save the container state so that recloning of the repository is not required but that is outside the scope of this document.</p>
</div>
</div>
<div id="jupyter-application-files" class="section level2">
<h2><span class="header-section-number">1.3</span> Jupyter Application Files</h2>
<div id="jupyer-notebook-code-examples" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Jupyer Notebook Code Examples</h3>
<p>If the steps in [#installation] were successfully followed to completion then the example application code will be available through the links in the <strong>jupyter</strong> directory tree view. The following sections describe the files, their usage, and possible avenues to use the stub code as a template to investigate other time series datasets. The <strong>jupyter</strong> files also contain markdown section with detailed descriptions of the code and its use.</p>
<div id="jupyter-file-data_explorer.ipynb" class="section level4">
<h4><span class="header-section-number">1.3.1.1</span> Jupyter File data_explorer.ipynb</h4>
<p>In the files section of the running <strong>jupyter notebook</strong> instance you will find the <strong>/data</strong> directory which contains the two datasets
required for the intended example applications. The file <strong>jupyter</strong> file <strong>data_explorer.ipynb</strong> pulls the data and prepares python pickle files for use by the application files.</p>
<blockquote>
<p>As long as you data is in <strong>.csv</strong> format, with an integer index beginning at zero, with all missing data interpolated, you can use <strong>data_explorer.ipynb</strong> as a template to import your own data sets. Your data must be in a <strong>.csv</strong> format with variable names in the column headers, all missing data backfilled and interpolated as required, and integer indexing starting at <span class="math inline">\(0\)</span>.</p>
</blockquote>
</div>
<div id="jupyter-file-data_prediction.ipynb" class="section level4">
<h4><span class="header-section-number">1.3.1.2</span> Jupyter File data_prediction.ipynb</h4>
</div>
<div id="jupyter-file-anomaly_detection.ipynb" class="section level4">
<h4><span class="header-section-number">1.3.1.3</span> Jupyter File anomaly_detection.ipynb</h4>
<p><strong>anomaly_detection.ipynb</strong> investigates using the number of states in the inferred model to make conclusions about the incoming data.</p>
</div>
<div id="jupyter-file-multivariate_analysis.ipynb" class="section level4">
<h4><span class="header-section-number">1.3.1.4</span> Jupyter File multivariate_analysis.ipynb</h4>
</div>
</div>
</div>
<div id="future-research-notes-and-thoughts-towards-a-stat946-final-project" class="section level2">
<h2><span class="header-section-number">1.4</span> Future Research | Notes and Thoughts Towards a STAT946 Final Project</h2>
<div id="future-research" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Future Research</h3>
</div>
</div>
<div id="to-do" class="section level2">
<h2><span class="header-section-number">1.5</span> To Do</h2>
<ul>
<li>Fix anomaly so it is on a limited set of data</li>
<li>Fix anomaly prediction so it works with soft linked variable names</li>
</ul>

<div id="refs" class="references">
<div>
<p>Saad, Feras A., and Vikash K. Mansinghka. 2018. “Temporally-Reweighted Chinese Restaurant Process Mixtures for Clustering, Imputing, and Forecasting Multivariate Time Series.” In <em>AISTATS 2018: Proceedings of the 21st International Conference on Artificial Intelligence and Statistics</em>, 84:755–64. Proceedings of Machine Learning Research. Playa Blanca, Lanzarote, Canary Islands: PMLR.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-saad2018trcrpm">
<p>Saad, Feras A., and Vikash K. Mansinghka. 2018. “Temporally-Reweighted Chinese Restaurant Process Mixtures for Clustering, Imputing, and Forecasting Multivariate Time Series.” In <em>AISTATS 2018: Proceedings of the 21st International Conference on Artificial Intelligence and Statistics</em>, 84:755–64. Proceedings of Machine Learning Research. Playa Blanca, Lanzarote, Canary Islands: PMLR.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
